create_pt2 <- read_lines("CEDS_v7_source_files/CreationPopulationScripts/ceds-nds-v7.1_pt2.sql")
library(tidyverse)
library(magrittr)
create_pt1 <- read_lines("CEDS_v7_source_files/CreationPopulationScripts/ceds-nds-v7.1_pt1.sql")
create_pt2 <- read_lines("CEDS_v7_source_files/CreationPopulationScripts/ceds-nds-v7.1_pt2.sql")
populateRef_pt8 <- read_lines("CEDS_v7_source_files/CreationPopulationScripts/Populate-CEDS-V7-Ref-Tables_pt8.sql")
populateRef_pt8 <- read_lines("CEDS_v7_source_files/CreationPopulationScripts/Populate-CEDS-V7-Ref-Tables_pt8.sql")
populateRef_pt9 <- read_lines("CEDS_v7_source_files/CreationPopulationScripts/Populate-CEDS-V7-Ref-Tables_pt9.sql")
populateRef_pt10 <- read_lines("CEDS_v7_source_files/CreationPopulationScripts/Populate-CEDS-V7-Ref-Tables_pt10.sql")
populateRef_pt11<- read_lines("CEDS_v7_source_files/CreationPopulationScripts/Populate-CEDS-V7-Ref-Tables_pt11.sql")
create_pt3 <- read_lines("CEDS_v7_source_files/CreationPopulationScripts/ceds-nds-v7.1_pt3.sql")
create_pt4 <- read_lines("CEDS_v7_source_files/CreationPopulationScripts/ceds-nds-v7.1_pt4.sql")
create_pt5 <- read_lines("CEDS_v7_source_files/CreationPopulationScripts/ceds-nds-v7.1_pt5.sql")
create_pt6 <- read_lines("CEDS_v7_source_files/CreationPopulationScripts/ceds-nds-v7.1_pt6.sql")
populateElements_pt7 <- read_lines("CEDS_v7_source_files/CreationPopulationScripts/Populate-CEDS-V7-Element-Tables_pt7.sql")
completeCreateInsert_v7 <- c(create_pt1,
create_pt2,
create_pt3,
create_pt4,
create_pt5,
create_pt6,
populateElements_pt7,
populateRef_pt8,
populateRef_pt9,
populateRef_pt10,
populateRef_pt11
)
fileConn <- file("TSQL_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
writeLines(completeCreateInsert, fileConn)
writeLines(completeCreateInsert_v7, fileConn)
dir.create("TSQLv7_camelCase/")
fileConn <- file("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
writeLines(completeCreateInsert_v7, fileConn)
close(fileConn)
library(tidyverse)
library(readxl)
library(bit64)
read_excel_width <- function(excel_file)
{
length(read_excel(excel_file, n_max = 0))
}
read_excel_headers <- function(excel_file)
{
read_excel(excel_file, n_max = 0) %>%
names %>%
.[1:11]
}
read_excel_coltypes <- function(excel_file)
{
read_excel(excel_file, skip = 1, n_max = 1) %>%
lapply(., class) %>%
.[1:11] %>%
unlist
}
read_charxl_full <- function(excel_file)
{
read_excel(excel_file, col_types ="text", col_names = F)
}
as.double_spprssWrns <- function(variables)
{
suppressWarnings(as.double(variables))
}
as.bigint_spprssWrns <- function(variables)
{
suppressWarnings(as.integer64(variables))
}
read_charxl_data <- function(excel_file)
{
read_charxl_full(excel_file) %>%
select(1:11) %>%
mutate_all(funs(as.numeric)) %>% #some vals disappear in some files if str8 to bigint (see 0920.xlsx)
mutate_all(round) %>%
filter(!is.na(X__11)) %>%
mutate_all(funs(as.integer64))
}
warnings()
dataRowCount_excel <- function(excel_file)
{
read_charxl_data(excel_file) %>%
nrow
}
sumOfColumn_excel <- function(excel_file)
{
sum_of_column <-
read_charxl_data(excel_file) %>%
select(11) %>%
mutate_all(round) %>%
summarise_all(funs(sum)) %>%
mutate_all(funs(as.numeric)) %>%
collect %>%
.[[1]]
sum_of_column
}
csv_convertAllText2bigint <- function (file_)
{
read_charxl_full(paste0(file_,".xlsx")) %>%
select(1:11) %>%
mutate(AmountNumeric = suppressWarnings(as.numeric(.[[ncol(.)]]))) %>% # last col to int
mutate(AmountRounded = round(.[[ncol(.)]])) %>% # round last col
select(1:10, ncol(.)) %>% # select 10 + Corrected Amount
filter(suppressWarnings(!is.na(AmountRounded))) %>%
mutate_all(funs(as.integer64(.))) %>%
write.csv(paste0(file_,".csv"), na = "", row.names = F)
}
chopit <- function(element) {
substr(element, 1, 5)
}
read_csv_data <- function(csv_file)
{
csv_data <-
read.csv(paste0(csv_file, ".csv"),
stringsAsFactors = F,
na.strings = c("", " ", "NA")) %>%
# mutate_all(funs(as.integer_spprssWrns)) #regular
mutate_all(funs(as.double_spprssWrns)) #oversized
csv_data
}
dataRowCount_csv <- function(csv_file)
{
dataRowCount <-
read_csv_data(csv_file) %>%
nrow
dataRowCount
}
sumOfColumn_csv <- function(csv_file)
{
sum_of_column <-
read_csv_data(csv_file) %>%
select(11) %>%
summarise_all(funs(sum)) %>%
collect %>%
.[[1]]
sum_of_column
}
file_extension <- "xlsx"
getwd()
file_path <- "C:/Users/Koyot/Documents/GitHub/readxl_bulkloadR/bulkloadR_staging/"
setwd(file_path)
getwd()
file_names <-
list.files(
path = file_path,
pattern = paste0("*.", file_extension))
print("file_names:")
file_names
file_ <-
sapply(file_names, chopit)
write.table(file_, "my_branch_list", na = "", row.names = F, sep = " ", col.names = F, quote = F, eol = " ")
print("file_:")
file_
cat("\n")
Tbl_widths <-
bind_cols(data_frame(file_names),
data.frame(do.call("rbind", lapply(file_names, read_excel_width)))) %>%
rename(num_cols = do.call..rbind...lapply.file_names..read_excel_width..)
print("Tbl_Widths:")
Tbl_widths
Tbl_widths <-
bind_cols(data_frame(file_names),
data.frame(do.call("rbind", lapply(file_names, read_excel_width))))# %>%
Tbl_widths
Tbl_widths <-
bind_cols(data_frame(file_names),
data.frame(do.call("rbind", lapply(file_names, read_excel_width))))# %>%
rename(num_cols = do.call..rbind...lapply.file_names..read_excel_width..)
file_ <-
sapply(file_names, chopit)
write.table(file_, "my_branch_list", na = "", row.names = F, sep = " ", col.names = F, quote = F, eol = " ")
print("file_:")
file_
cat("\n")
library(tidyverse)
library(readxl)
library(bit64)
read_excel_width <- function(excel_file)
{
length(read_excel(excel_file, n_max = 0))
}
read_excel_headers <- function(excel_file)
{
read_excel(excel_file, n_max = 0) %>%
names %>%
.[1:11]
}
read_excel_coltypes <- function(excel_file)
{
read_excel(excel_file, skip = 1, n_max = 1) %>%
lapply(., class) %>%
.[1:11] %>%
unlist
}
read_charxl_full <- function(excel_file)
{
read_excel(excel_file, col_types ="text", col_names = F)
}
as.double_spprssWrns <- function(variables)
{
suppressWarnings(as.double(variables))
}
as.bigint_spprssWrns <- function(variables)
{
suppressWarnings(as.integer64(variables))
}
read_charxl_data <- function(excel_file)
{
read_charxl_full(excel_file) %>%
select(1:11) %>%
mutate_all(funs(as.numeric)) %>% #some vals disappear in some files if str8 to bigint (see 0920.xlsx)
mutate_all(round) %>%
filter(!is.na(X__11)) %>%
mutate_all(funs(as.integer64))
}
warnings()
dataRowCount_excel <- function(excel_file)
{
read_charxl_data(excel_file) %>%
nrow
}
sumOfColumn_excel <- function(excel_file)
{
sum_of_column <-
read_charxl_data(excel_file) %>%
select(11) %>%
mutate_all(round) %>%
summarise_all(funs(sum)) %>%
mutate_all(funs(as.numeric)) %>%
collect %>%
.[[1]]
sum_of_column
}
csv_convertAllText2bigint <- function (file_)
{
read_charxl_full(paste0(file_,".xlsx")) %>%
select(1:11) %>%
mutate(AmountNumeric = suppressWarnings(as.numeric(.[[ncol(.)]]))) %>% # last col to int
mutate(AmountRounded = round(.[[ncol(.)]])) %>% # round last col
select(1:10, ncol(.)) %>% # select 10 + Corrected Amount
filter(suppressWarnings(!is.na(AmountRounded))) %>%
mutate_all(funs(as.integer64(.))) %>%
write.csv(paste0(file_,".csv"), na = "", row.names = F)
}
chopit <- function(element) {
substr(element, 1, 5)
}
read_csv_data <- function(csv_file)
{
csv_data <-
read.csv(paste0(csv_file, ".csv"),
stringsAsFactors = F,
na.strings = c("", " ", "NA")) %>%
# mutate_all(funs(as.integer_spprssWrns)) #regular
mutate_all(funs(as.double_spprssWrns)) #oversized
csv_data
}
dataRowCount_csv <- function(csv_file)
{
dataRowCount <-
read_csv_data(csv_file) %>%
nrow
dataRowCount
}
sumOfColumn_csv <- function(csv_file)
{
sum_of_column <-
read_csv_data(csv_file) %>%
select(11) %>%
summarise_all(funs(sum)) %>%
collect %>%
.[[1]]
sum_of_column
}
file_extension <- "xlsx"
getwd()
file_path <- "C:/Users/Koyot/Documents/GitHub/readxl_bulkloadR/bulkloadR_staging/"
setwd(file_path)
options(stringsAsFactors = FALSE) # To deal with the UTF-16 format read.csv is necessary
library(tidyverse)
library(magrittr)
library(tidyverse)
library(magrittr)
getwd()
setwd("../../aws_ceds_v7/")
createUpdate_CEDS6_TSQL <- read_lines("/TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
createUpdate_CEDS6_TSQL <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
cu_ceds6_tsql_sc <- gsub("(?<=[a-z0-9])[A-Z]|(?!^)[A-Z](?=[a-z])", "_\\1", createUpdate_CEDS6_TSQL, perl = T)
cu_ceds6_tsql_sc %<>% gsub("\\[CEDS-TSQL-V7\\]",  "\\[CEDS_TSQL_v7_snake_case\\]", .)
dir.create("tsql_ceds_v7_snake_case")
clippablefile_path <- "tsql_ceds_v7_snake_case_/tsql_ceds_v7_snake_case.sql"
write_lines(cu_ceds6_tsql_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("(?<=[a-z0-9])[A-Z]|(?!^)[A-Z](?=[a-z])", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc %<>% gsub("\\[CEDS-TSQL-V7\\]",  "\\[CEDS_TSQL_v7_snake_case\\]", .)
tsql_ceds7_sc %<>% gsub("Progress_([ABC])Indicator",  "Progress_\\1_Indicator", ., perl = T)
tsql_ceds7_sc %<>% gsub("Rating_([ABC])Id",  "Rating_\\1_Id", ., perl = T)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("(?<=[a-z0-9])[A-Z]|(?!^)[A-Z](?=[a-z])", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc %<>% gsub("\\[CEDS-TSQL-V7\\]",  "\\[CEDS_TSQL_v7_snake_case\\]", .)
clippablefile_path <- "tsql_ceds_v7_snake_case_/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("(?<=[a-z0-9])[A-Z]|(?!^)[A-Z](?=[a-z])", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc %<>% gsub("\\[CEDS-TSQL-V7\\]",  "\\[CEDS_TSQL_v7_snake_case\\]", .)
dir.create("tsql_ceds_v7_snake_case")
clippablefile_path <- "tsql_ceds_v7_snake_case_/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
clippablefile_path <- file("tsql_ceds_v7_snake_case_/tsql_ceds_v7_snake_case.sql")
write_lines(tsql_ceds7_sc, clippablefile_path)
clippablefile_path <- file("tsql_ceds_v7_snake_case_/tsql_ceds_v7_snake_case.sql")
write_lines(tsql_ceds7_sc, clippablefile_path)
dir.create("tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case.sql")
clippablefile_path <- file("tsql_ceds_v7_snake_case_/tsql_ceds_v7_snake_case.sql")
write_lines(tsql_ceds7_sc, clippablefile_path)
writeLines(tsql_ceds7_sc, clippablefile_path)
clippablefile_path <- file("tsql_ceds_v7_snake_case_/tsql_ceds_v7_snake_case.sql")
writeLines(tsql_ceds7_sc, clippablefile_path)
clippablefile_path <- "tsql_ceds_v7_snake_case_/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
file.create("createUpdateTSQLCEDSv7")
clippablefile_path <- "tsql_ceds_v7_snake_case_/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
file.create("createUpdateTSQLCEDSv7.sql")
clippablefile_path <- "tsql_ceds_v7_snake_case_/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
file.create("tsql_ceds_v7_snake_case/createUpdateTSQLCEDSv7.sql")
clippablefile_path <- "tsql_ceds_v7_snake_case_/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
file.create("tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case.sql")
clippablefile_path <- "tsql_ceds_v7_snake_case_/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
clippablefile_path <- "tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?!^)[A-Z](?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc %<>% gsub("\\[CEDS-NDS-V7\\]",  "\\[tsql_ceds7_sc\\]", .)
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?![)[A-Z](?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?!\\[)[A-Z](?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9\\[])[A-Z]|(?!^)[A-Z](?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9\\\[])[A-Z]|(?!^)[A-Z](?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?!\\[)[A-Z](?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
write_lines(tsql_ceds7_sc, clippablefile_path)
tsql_ceds7_sc <- createUpdateTSQLCEDSv7
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?![\\[])[A-Z](?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[])[A-Z](?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[])[A-Z](?!to)(?=[a-z])", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[])[A-Z](?!=to)(?=[a-z])", "_\\1", createUpdateTSQLCEDSv7, perl = T)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[])[A-Z](?!to)(?=[a-z])", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[])[A-Z](?!(to))(?=[a-z])", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[])[A-Z](?!to)(?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[])[A-Z](?!to)(?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc %<>% gsub("\\[CEDS-NDS-V7\\]",  "\\[tsql_ceds7_sc\\]", .)
tsql_ceds7_sc %<>% gsub("CEDSto_",  "CEDS_to_", ., perl = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[\\'])[A-Z](?!to)(?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc %<>% gsub("\\[CEDS-NDS-V7\\]",  "\\[tsql_ceds7_sc\\]", .)
tsql_ceds7_sc %<>% gsub("CEDSto_",  "CEDS_to_", ., perl = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[\\'])[A-Z](?!to)(?=[a-z])|(?!^)[A-Z](?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc %<>% gsub("\\[CEDS-NDS-V7\\]",  "\\[tsql_ceds7_sc\\]", .)
tsql_ceds7_sc %<>% gsub("CEDSto_",  "CEDS_to_", ., perl = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[\\'\\s+])[A-Z](?!to)(?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc %<>% gsub("\\[CEDS-NDS-V7\\]",  "\\[tsql_ceds7_sc\\]", .)
tsql_ceds7_sc %<>% gsub("CEDSto_",  "CEDS_to_", ., perl = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
tsql_ceds7_sc %<>% gsub("Pre_*K(indergarten)*",  "Pre_K\\1_", ., perl = T, ignore.case = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
tsql_ceds7_sc %<>% gsub("Title_*1",  "Title_1_", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("Is_User_Table",  "IsUserTable", ., perl = T, ignore.case = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
sc <- function(dat, ABBR) {
gsub(paste0("('|_|\\[)", ABBR, "([A-Z])"),  paste0("\\1", ABBR, "_\\2"), dat, perl = T)
}
tsql_ceds7_sc %<>% sc(., "IEP")
write_lines(tsql_ceds7_sc, clippablefile_path)
sc <- function(dat, ABBR) {
sc <- function(dat, ABBR) {
gsub(paste0("('|_|\\[)", ABBR, "([A-Z])"),  paste0("\\1", ABBR, "_\\2"), dat, perl = T)
}
sc <- function(dat, ABBR) {
gsub(paste0("('|_|\\[)", ABBR, "([A-Z])"),  paste0("\\1", ABBR, "_\\2"), dat, perl = T)
}
tsql_ceds7_sc %<>% sc(., "IDEA")
write_lines(tsql_ceds7_sc, clippablefile_path)
tsql_ceds7_sc %<>% sc(., "XPK")
write_lines(tsql_ceds7_sc, clippablefile_path)
tsql_ceds7_sc %<>% gsub("__",  "_", .)
write_lines(tsql_ceds7_sc, clippablefile_path)
tsql_ceds7_sc %<>% gsub("__",  "_", .)
clippablefile_path <- "tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[\\'\\s+])[A-Z](?!to)(?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc %<>% gsub("\\[CEDS-NDS-V7\\]",  "\\[tsql_ceds7_sc\\]", .)
tsql_ceds7_sc %<>% gsub("CEDSto_",  "CEDS_to_", ., perl = T)
tsql_ceds7_sc %<>% gsub("Pre_*K(indergarten)*",  "Pre_K\\1_", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("Title_*1",  "Title_1_", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("CENSUSID",  "CENSUS_ID", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("Is_User_Table",  "IsUserTable", ., perl = T, ignore.case = T)
sc <- function(dat, ABBR) {
gsub(paste0("('|_|\\[)", ABBR, "([A-Z])"),  paste0("\\1", ABBR, "_\\2"), dat, perl = T)
}
tsql_ceds7_sc %<>% sc(., "IDEA")
tsql_ceds7_sc %<>% sc(., "IEP")
tsql_ceds7_sc %<>% sc(., "XPK")
tsql_ceds7_sc %<>% sc(., "Part_B")
tsql_ceds7_sc %<>% gsub("__",  "_", .)
clippablefile_path <- "tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
tsql_ceds7_sc %<>% gsub("__",  "_", .)
clippablefile_path <- "tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[\\'\\s+])[A-Z](?!to)(?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc %<>% gsub("\\[CEDS-NDS-V7\\]",  "\\[tsql_ceds7_sc\\]", .)
tsql_ceds7_sc %<>% gsub("CEDSto_",  "CEDS_to_", ., perl = T)
tsql_ceds7_sc %<>% gsub("Pre_*K(indergarten)*",  "Pre_K\\1_", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("Title_*1",  "Title_1_", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("CENSUSID",  "CENSUS_ID", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("Is_User_Table",  "IsUserTable", ., perl = T, ignore.case = T)
sc <- function(dat, ABBR) {
gsub(paste0("('|_|\\[)", ABBR, "([A-Z])"),  paste0("\\1", ABBR, "_\\2"), dat, perl = T)
}
tsql_ceds7_sc %<>% sc(., "IDEA")
tsql_ceds7_sc %<>% sc(., "IEP")
tsql_ceds7_sc %<>% sc(., "XPK")
tsql_ceds7_sc %<>% sc(., "Part_B")
write_lines(tsql_ceds7_sc, clippablefile_path)
tsql_ceds7_sc %<>% gsub("_+",  "_", .)
clippablefile_path <- "tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
