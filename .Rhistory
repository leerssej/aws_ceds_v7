rs_ceds_v7_sc_orig <- read_lines(origscript_path)
rs_ceds7_sc <- rs_ceds_v7_sc_orig
rs_ceds7_sc %<>% sub("CREATE SCHEMA dbo;",  " CREATE SCHEMA rs_ceds7_sc;", .)
rs_ceds7_sc %<>% gsub("\\s+dbo\\.",  " rs_ceds7_sc.", .)
rs_ceds7_sc %<>% gsub('"(.*?)"',  "\\L\\1", ., perl = T)
rs_ceds7_sc %<>% gsub("primary_telephone_number_indicator bool DEFAULT 0 NOT NULL",  "primary_telephone_number_indicator bool DEFAULT FALSE NOT NULL", ., perl = T)
rs_ceds7_sc %<>% gsub("fk_ps_section\\s+_ref_course_",  "fk_ps_section_ref_course_", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("student_financial_aid_ref_financial_aid_veterans_benefit",  "student_financial_aid_ref_fin_aid_vtrns_bnft", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("org_identification_system\\s+_ref_organization_identifier_type",  "org_identification_system_ref_organization_identifier_type", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("dentification_system\\s+_ref_person_identifier",  "dentification_system_ref_person_identifier", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("fk_organization_fed(era)*l*_accountability",  "fk_organization_fed_accntblty", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')(\\w+)'s(?=\\s+(\\w+|\\())",  "\\1\\2''s", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub(" student's', ",  " student''s', ", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("='Accrediting Organization' when Accreditation Agency is set to 'Other Accreditation Agency\\.', ",  "=`Accrediting Organization` when Accreditation Agency is set to `Other Accreditation Agency.`',  ", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')(\\w+)n't(?=\\s\\w+)",  "\\1\\2n''t", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub(" parents' ",  " parents'' ", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
origscript_path <- "awsql_ceds_v7_snake_case/original/redshift_ceds_v7_snake_case.sql"
rs_ceds_v7_sc_orig <- read_lines(origscript_path)
rs_ceds7_sc <- rs_ceds_v7_sc_orig
rs_ceds7_sc %<>% sub("CREATE SCHEMA dbo;",  " CREATE SCHEMA rs_ceds7_sc;", .)
rs_ceds7_sc %<>% gsub("\\s+dbo\\.",  " rs_ceds7_sc.", .)
rs_ceds7_sc %<>% gsub('"(.*?)"',  "\\L\\1", ., perl = T)
rs_ceds7_sc %<>% gsub("primary_telephone_number_indicator bool DEFAULT 0 NOT NULL",  "primary_telephone_number_indicator bool DEFAULT FALSE NOT NULL", ., perl = T)
rs_ceds7_sc %<>% gsub("fk_ps_section\\s+_ref_course_",  "fk_ps_section_ref_course_", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("student_financial_aid_ref_financial_aid_veterans_benefit",  "student_financial_aid_ref_fin_aid_vtrns_bnft", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("org_identification_system\\s+_ref_organization_identifier_type",  "org_identification_system_ref_organization_identifier_type", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("dentification_system\\s+_ref_person_identifier",  "dentification_system_ref_person_identifier", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("fk_organization_fed(era)*l*_accountability",  "fk_organization_fed_accntblty", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')(\\w+)'s(?=\\s+(\\w+|\\())",  "\\1\\2''s", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("='Accrediting Organization' when Accreditation Agency is set to 'Other Accreditation Agency\\.', ",  "=`Accrediting Organization` when Accreditation Agency is set to `Other Accreditation Agency.`',  ", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')(\\w+)n't(?=\\s\\w+)",  "\\1\\2n''t", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("(\\s|')([A-Z]{2})'s(?=\\s\\w+)",  "\\1\\2''s", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("(\\s|')([A-Z]{2})'s'",  "\\1\\2''s'", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("(\\s|')(\\w+)s'(?=\\s\\w+)",  "\\1\\2s''", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("Doctoral \\(Doctor's\\) degree",  "Doctoral (Doctor''s) degree", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("Post-master's certificate",  "Post-master''s certificate", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
origscript_path <- "awsql_ceds_v7_snake_case/original/redshift_ceds_v7_snake_case.sql"
rs_ceds_v7_sc_orig <- read_lines(origscript_path)
rs_ceds7_sc <- rs_ceds_v7_sc_orig
rs_ceds7_sc %<>% sub("CREATE SCHEMA dbo;",  " CREATE SCHEMA rs_ceds7_sc;", .)
rs_ceds7_sc %<>% gsub("\\s+dbo\\.",  " rs_ceds7_sc.", .)
rs_ceds7_sc %<>% gsub('"(.*?)"',  "\\L\\1", ., perl = T)
rs_ceds7_sc %<>% gsub("primary_telephone_number_indicator bool DEFAULT 0 NOT NULL",  "primary_telephone_number_indicator bool DEFAULT FALSE NOT NULL", ., perl = T)
rs_ceds7_sc %<>% gsub("fk_ps_section\\s+_ref_course_",  "fk_ps_section_ref_course_", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("student_financial_aid_ref_financial_aid_veterans_benefit",  "student_financial_aid_ref_fin_aid_vtrns_bnft", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("org_identification_system\\s+_ref_organization_identifier_type",  "org_identification_system_ref_organization_identifier_type", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("dentification_system\\s+_ref_person_identifier",  "dentification_system_ref_person_identifier", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("fk_organization_fed(era)*l*_accountability",  "fk_organization_fed_accntblty", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')(\\w+)'s(?=\\s+(\\w+|\\())",  "\\1\\2''s", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("='Accrediting Organization' when Accreditation Agency is set to 'Other Accreditation Agency\\.', ",  "=`Accrediting Organization` when Accreditation Agency is set to `Other Accreditation Agency.`',  ", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')(\\w+)n't(?=\\s\\w+)",  "\\1\\2n''t", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')([A-Z]{2})'s(?=\\s\\w+)",  "\\1\\2''s", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')([A-Z]{2})'s'",  "\\1\\2''s'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')(\\w+)s'(?=\\s\\w+)",  "\\1\\2s''", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("Post-master's certificate",  "Post-master''s certificate", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("C\\?te d'Ivoire",  "Cote dIvoire", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+\\?*\\s*\\w+\\?*)''(?=,)",  "'\\1'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+)'(\\w+)'",  "'\\1 \\2'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+\\s)(\\w+)'(\\w+)'",  "'\\1 \\2 \\3'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+)'\\s(\\w+)'",  "'\\1 \\2'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub(", ''(\\w+)(\\s\\w+)', ",  ", '\\1\\2', ", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub(", ''(\\w+)', ",  ", '\\1', ", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+)'(\\w+\\s\\w+)'",  "'\\1\\2'", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("'Mi'kmaq; Micmac'",  "'Mi''kmaq; Micmac'", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("St. Mary's",  "St. Mary''s", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("Port Gamble S'Klallam Tribe",  "Port Gamble S''Klallam Tribe", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub(" \\(formerly SSIG's\\)",  " (formerly SSIG''s)", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("'Ta'izzi-Adeni Arabic'",  "'Taizzi Adeni Arabic'", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
tsql_ceds7_sc %<>% sc(., "Part_B")
library(tidyverse)
library(magrittr)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[\\'\\s+\\.@\\(\\\"-])[A-Z](?!to)(?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc %<>% gsub("\\[CEDS-NDS-V7\\]",  "\\[tsql_ceds7_sc\\]", .)
tsql_ceds7_sc %<>% gsub("CEDSto_",  "CEDS_to_", ., perl = T)
tsql_ceds7_sc %<>% gsub("Pre_*K(indergarten)*",  "Pre_K\\1_", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("Title_*1",  "Title_1_", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("CENSUSID",  "CENSUS_ID", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub(" SE_As ",  " SEA''s ", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("Is_User_Table",  "IsUserTable", ., perl = T, ignore.case = T)
sc <- function(dat, ABBR) {
gsub(paste0("('|_|\\[)", ABBR, "([A-Z])"),  paste0("\\1", ABBR, "_\\2"), dat, perl = T)
}
tsql_ceds7_sc %<>% sc(., "IDEA")
tsql_ceds7_sc %<>% sc(., "IEP")
tsql_ceds7_sc %<>% sc(., "XPK")
tsql_ceds7_sc %<>% sc(., "Part_B")
tsql_ceds7_sc %<>% gsub("_+",  "_", .)
clippablefile_path <- "tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
block_1 <- read_lines(clippablefile_path, n_max = 9993)
block_2 <- read_lines(clippablefile_path, skip = 9993, n_max = 9000)
block_3 <- read_lines(clippablefile_path, skip = 18993, n_max = 9994)
block_4 <- read_lines(clippablefile_path, skip = 28988, n_max = 9988)
block_5 <- read_lines(clippablefile_path, skip = 38977, n_max = 9995)
block_6 <- read_lines(clippablefile_path, skip = 48974, n_max = 9993)
block_7 <- read_lines(clippablefile_path, skip = 58967, n_max = 9946)
block_8 <- read_lines(clippablefile_path, skip = 68915, n_max = 9997)
block_9 <- read_lines(clippablefile_path, skip = 78912, n_max = 9991)
block_10 <- read_lines(clippablefile_path, skip = 88905, n_max = 10000)
clippablefile_root <- "tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case_blocks/"
write_lines(block_1, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt1.sql"))
write_lines(block_2, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt2.sql"))
write_lines(block_3, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt3.sql"))
write_lines(block_4, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt4.sql"))
write_lines(block_5, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt5.sql"))
write_lines(block_6, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt6.sql"))
write_lines(block_7, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt7.sql"))
write_lines(block_8, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt8.sql"))
write_lines(block_9, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt9.sql"))
write_lines(block_10, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt10.sql"))
write_lines(block_4, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt4.sql"))
origscript_path <- "redshift_ceds_v7_snake_case/original/redshift_ceds_v7_snake_case.sql"
rs_ceds_v7_sc_orig <- read_lines(origscript_path)
origscript_path <- "redshift_ceds_v7_snake_case/redshift_ceds_v7_snake_case.sql"
rs_ceds_v7_sc_orig <- read_lines(origscript_path)
rs_ceds7_sc <- rs_ceds_v7_sc_orig
rs_ceds7_sc %<>% sub("CREATE SCHEMA dbo;",  " CREATE SCHEMA rs_ceds7_sc;", .)
rs_ceds7_sc %<>% gsub("\\s+dbo\\.",  " rs_ceds7_sc.", .)
rs_ceds7_sc %<>% gsub('"(.*?)"',  "\\L\\1", ., perl = T)
rs_ceds7_sc %<>% gsub("primary_telephone_number_indicator bool DEFAULT 0 NOT NULL",  "primary_telephone_number_indicator bool DEFAULT FALSE NOT NULL", ., perl = T)
rs_ceds7_sc %<>% gsub("fk_ps_section\\s+_ref_course_",  "fk_ps_section_ref_course_", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("student_financial_aid_ref_financial_aid_veterans_benefit",  "student_financial_aid_ref_fin_aid_vtrns_bnft", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("org_identification_system\\s+_ref_organization_identifier_type",  "org_identification_system_ref_organization_identifier_type", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("dentification_system\\s+_ref_person_identifier",  "dentification_system_ref_person_identifier", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("fk_organization_fed(era)*l*_accountability",  "fk_organization_fed_accntblty", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')(\\w+)'s(?=\\s+(\\w+|\\())",  "\\1\\2''s", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("='Accrediting Organization' when Accreditation Agency is set to 'Other Accreditation Agency\\.', ",  "=`Accrediting Organization` when Accreditation Agency is set to `Other Accreditation Agency.`',  ", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')(\\w+)n't(?=\\s\\w+)",  "\\1\\2n''t", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')([A-Z]{2})'s(?=\\s\\w+)",  "\\1\\2''s", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')([A-Z]{2})'s'",  "\\1\\2''s'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')(\\w+)s'(?=\\s\\w+)",  "\\1\\2s''", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("Post-master's certificate",  "Post-master''s certificate", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("C\\?te d'Ivoire",  "Cote dIvoire", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+\\?*\\s*\\w+\\?*)''(?=,)",  "'\\1'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+)'(\\w+)'",  "'\\1 \\2'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+\\s)(\\w+)'(\\w+)'",  "'\\1 \\2 \\3'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+)'\\s(\\w+)'",  "'\\1 \\2'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub(", ''(\\w+)(\\s\\w+)', ",  ", '\\1\\2', ", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub(", ''(\\w+)', ",  ", '\\1', ", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+)'(\\w+\\s\\w+)'",  "'\\1\\2'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'Mi'kmaq; Micmac'",  "'Mi''kmaq; Micmac'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("St. Mary's",  "St. Mary''s", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("Port Gamble S'Klallam Tribe",  "Port Gamble S''Klallam Tribe", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub(" \\(formerly SSIG's\\)",  " (formerly SSIG''s)", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'Ta'izzi-Adeni Arabic'",  "'Taizzi Adeni Arabic'", ., perl = T, ignore.case = T)
clippable_fileroot <- "awsql_ceds_v7_snake_case/awsql_ceds_v7_snake_case_script_blocks/"
complete_translation <- "rs_ceds7_sc.sql"
completetranslation_filepath <- paste0(clippable_fileroot, complete_translation)
dir.create(clippable_fileroot)
clippable_fileroot <- "awsql_ceds_v7_snake_case/awsql_ceds_v7_snake_case_script_blocks/"
complete_translation <- "rs_ceds7_sc.sql"
completetranslation_filepath <- paste0(clippable_fileroot, complete_translation)
dir.create(clippable_fileroot)
clippable_fileroot <- "redshift_ceds_v7_snake_case/redshift_ceds_v7_snake_case_script_blocks/"
complete_translation <- "rs_ceds7_sc.sql"
completetranslation_filepath <- paste0(clippable_fileroot, complete_translation)
dir.create(clippable_fileroot)
write_lines(rs_ceds7_sc, completetranslation_filepath)
origscript_path <- "redshift_ceds_v7_snake_case/redshift_ceds_v7_snake_case.sql"
rs_ceds_v7_sc_orig <- read_lines(origscript_path)
rs_ceds7_sc <- rs_ceds_v7_sc_orig
rs_ceds7_sc %<>% sub("CREATE SCHEMA dbo;",  "CREATE SCHEMA rs_ceds7_sc;", .)
rs_ceds7_sc %<>% gsub("\\s+dbo\\.",  " rs_ceds7_sc.", .)
rs_ceds7_sc %<>% gsub('"(.*?)"',  "\\L\\1", ., perl = T)
rs_ceds7_sc %<>% gsub("primary_telephone_number_indicator bool DEFAULT 0 NOT NULL",  "primary_telephone_number_indicator bool DEFAULT FALSE NOT NULL", ., perl = T)
rs_ceds7_sc %<>% gsub("fk_ps_section\\s+_ref_course_",  "fk_ps_section_ref_course_", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("student_financial_aid_ref_financial_aid_veterans_benefit",  "student_financial_aid_ref_fin_aid_vtrns_bnft", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("org_identification_system\\s+_ref_organization_identifier_type",  "org_identification_system_ref_organization_identifier_type", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("dentification_system\\s+_ref_person_identifier",  "dentification_system_ref_person_identifier", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("fk_organization_fed(era)*l*_accountability",  "fk_organization_fed_accntblty", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')(\\w+)'s(?=\\s+(\\w+|\\())",  "\\1\\2''s", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("='Accrediting Organization' when Accreditation Agency is set to 'Other Accreditation Agency\\.', ",  "=`Accrediting Organization` when Accreditation Agency is set to `Other Accreditation Agency.`',  ", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')(\\w+)n't(?=\\s\\w+)",  "\\1\\2n''t", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')([A-Z]{2})'s(?=\\s\\w+)",  "\\1\\2''s", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')([A-Z]{2})'s'",  "\\1\\2''s'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')(\\w+)s'(?=\\s\\w+)",  "\\1\\2s''", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("Post-master's certificate",  "Post-master''s certificate", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("C\\?te d'Ivoire",  "Cote dIvoire", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+\\?*\\s*\\w+\\?*)''(?=,)",  "'\\1'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+)'(\\w+)'",  "'\\1 \\2'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+\\s)(\\w+)'(\\w+)'",  "'\\1 \\2 \\3'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+)'\\s(\\w+)'",  "'\\1 \\2'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub(", ''(\\w+)(\\s\\w+)', ",  ", '\\1\\2', ", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub(", ''(\\w+)', ",  ", '\\1', ", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+)'(\\w+\\s\\w+)'",  "'\\1\\2'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'Mi'kmaq; Micmac'",  "'Mi''kmaq; Micmac'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("St. Mary's",  "St. Mary''s", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("Port Gamble S'Klallam Tribe",  "Port Gamble S''Klallam Tribe", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub(" \\(formerly SSIG's\\)",  " (formerly SSIG''s)", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("'Ta'izzi-Adeni Arabic'",  "'Taizzi Adeni Arabic'", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("'Daats'i\\?in'",  "'Daatsi?in'", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("d'Oreille",  "d''Oreille", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("ut-Ma'in",  "ut-Ma in", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("Hawai'i",  "Hawaii", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("Ju/'hoan",  "Ju/hoan", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("Kuuku-Ya'u",  "Kuuku-Yau", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("E'\\?apa Woromaipu",  "Eapa Woromaipu", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("'Zo'\\?'",  "'Zo?'", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("'Toraja-Sa'dan'",  "'Toraja-Sadan'", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("Me'phaa",  "Me phaa", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("'Ts'\\?n-Lao'",  "'Ts ?n-Lao'", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("'Wik-Me'anha'",  "'Wik-Me anha'", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
block_1 <- read_lines(clippable_filepath, n_max = 9950)
clippable_filepath <- completetranslation_filepath
block_1 <- read_lines(clippable_filepath, n_max = 9950)
write_lines(block_1, paste0(clippable_fileroot, "awsql_rs_ceds7_sc_create_update_redux3_pt1.sql"))
block_1 <- read_lines(clippable_filepath, n_max = 10000)
write_lines(block_1, paste0(clippable_fileroot, "rs_ceds7_sc_pt1.sql"))
block_1 <- read_lines(clippable_filepath, n_max = 9970)
write_lines(block_1, paste0(clippable_fileroot, "rs_ceds7_sc_pt1.sql"))
block_2 <- read_lines(clippable_filepath, skip = 9970, n_max = 10000)
write_lines(block_2, paste0(clippable_fileroot, "rs_ceds7_sc_pt2.sql"))
block_2 <- read_lines(clippable_filepath, skip = 9970, n_max = 9995)
write_lines(block_2, paste0(clippable_fileroot, "rs_ceds7_sc_pt2.sql"))
block_3 <- read_lines(clippable_filepath, skip = 19962, n_max = 10000)
write_lines(block_3, paste0(clippable_fileroot, "rs_ceds7_sc_pt3.sql"))
block_3 <- read_lines(clippable_filepath, skip = 19965, n_max = 10000)
write_lines(block_3, paste0(clippable_fileroot, "rs_ceds7_sc_pt3.sql"))
block_3 <- read_lines(clippable_filepath, skip = 19964, n_max = 10000)
write_lines(block_3, paste0(clippable_fileroot, "rs_ceds7_sc_pt3.sql"))
block_3 <- read_lines(clippable_filepath, skip = 19965, n_max = 10000)
write_lines(block_3, paste0(clippable_fileroot, "rs_ceds7_sc_pt3.sql"))
block_3 <- read_lines(clippable_filepath, skip = 19965, n_max = 9595)
block_4 <- read_lines(clippable_filepath, skip = 29560, n_max = 10000)
write_lines(block_3, paste0(clippable_fileroot, "rs_ceds7_sc_pt3.sql"))
write_lines(block_4, paste0(clippable_fileroot, "rs_ceds7_sc_pt4.sql"))
block_4 <- read_lines(clippable_filepath, skip = 29560, n_max = 9996)
write_lines(block_4, paste0(clippable_fileroot, "rs_ceds7_sc_pt4.sql"))
block_4 <- read_lines(clippable_filepath, skip = 29560, n_max = 9996)
block_5 <- read_lines(clippable_filepath, skip = 39556, n_max = 10000)
write_lines(block_3, paste0(clippable_fileroot, "rs_ceds7_sc_pt3.sql"))
write_lines(block_4, paste0(clippable_fileroot, "rs_ceds7_sc_pt4.sql"))
write_lines(block_5, paste0(clippable_fileroot, "rs_ceds7_sc_pt5.sql"))
origscript_path <- "redshift_ceds_v7_snake_case/original/redshift_ceds_v7_snake_case.sql"
rs_ceds_v7_sc_orig <- read_lines(origscript_path)
rs_ceds7_sc <- rs_ceds_v7_sc_orig
rs_ceds7_sc %<>% sub("CREATE SCHEMA dbo;",  "CREATE SCHEMA rs_ceds7_sc;", .)
rs_ceds7_sc %<>% gsub("\\s+dbo\\.",  " rs_ceds7_sc.", .)
rs_ceds7_sc %<>% gsub('"(.*?)"',  "\\L\\1", ., perl = T)
rs_ceds7_sc %<>% gsub("primary_telephone_number_indicator bool DEFAULT 0 NOT NULL",  "primary_telephone_number_indicator bool DEFAULT FALSE NOT NULL", ., perl = T)
rs_ceds7_sc %<>% gsub("fk_ps_section\\s+_ref_course_",  "fk_ps_section_ref_course_", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("student_financial_aid_ref_financial_aid_veterans_benefit",  "student_financial_aid_ref_fin_aid_vtrns_bnft", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("org_identification_system\\s+_ref_organization_identifier_type",  "org_identification_system_ref_organization_identifier_type", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("dentification_system\\s+_ref_person_identifier",  "dentification_system_ref_person_identifier", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("fk_organization_fed(era)*l*_accountability",  "fk_organization_fed_accntblty", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')(\\w+)'s(?=\\s+(\\w+|\\())",  "\\1\\2''s", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("='Accrediting Organization' when Accreditation Agency is set to 'Other Accreditation Agency\\.', ",  "=`Accrediting Organization` when Accreditation Agency is set to `Other Accreditation Agency.`',  ", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')(\\w+)n't(?=\\s\\w+)",  "\\1\\2n''t", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')([A-Z]{2})'s(?=\\s\\w+)",  "\\1\\2''s", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')([A-Z]{2})'s'",  "\\1\\2''s'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')(\\w+)s'(?=\\s\\w+)",  "\\1\\2s''", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("Post-master's certificate",  "Post-master''s certificate", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("C\\?te d'Ivoire",  "Cote dIvoire", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+\\?*\\s*\\w+\\?*)''(?=,)",  "'\\1'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+)'(\\w+)'",  "'\\1 \\2'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+\\s)(\\w+)'(\\w+)'",  "'\\1 \\2 \\3'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+)'\\s(\\w+)'",  "'\\1 \\2'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub(", ''(\\w+)(\\s\\w+)', ",  ", '\\1\\2', ", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub(", ''(\\w+)', ",  ", '\\1', ", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+)'(\\w+\\s\\w+)'",  "'\\1\\2'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'Mi'kmaq; Micmac'",  "'Mi''kmaq; Micmac'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("St. Mary's",  "St. Mary''s", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("Port Gamble S'Klallam Tribe",  "Port Gamble S''Klallam Tribe", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub(" \\(formerly SSIG's\\)",  " (formerly SSIG''s)", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'Ta'izzi-Adeni Arabic'",  "'Taizzi Adeni Arabic'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'Daats'i\\?in'",  "'Daatsi?in'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("d'Oreille",  "d''Oreille", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("ut-Ma'in",  "ut-Ma in", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("Hawai'i",  "Hawaii", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("Ju/'hoan",  "Ju/hoan", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("Kuuku-Ya'u",  "Kuuku-Yau", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("E'\\?apa Woromaipu",  "Eapa Woromaipu", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'Zo'\\?'",  "'Zo?'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'Toraja-Sa'dan'",  "'Toraja-Sadan'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("Me'phaa",  "Me phaa", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("fk_individualized_program_progress_report_plan",  "fk_individ_prgrm_prog_rprt_pln", ., perl = T, ignore.case = T)
clippable_fileroot <- "redshift_ceds_v7_snake_case/redshift_ceds_v7_snake_case_script_blocks/"
complete_translation <- "rs_ceds7_sc.sql"
completetranslation_filepath <- paste0(clippable_fileroot, complete_translation)
dir.create(clippable_fileroot)
write_lines(rs_ceds7_sc, completetranslation_filepath)
clippable_filepath <- completetranslation_filepath
block_1 <- read_lines(clippable_filepath, n_max = 9970)
block_2 <- read_lines(clippable_filepath, skip = 9970, n_max = 9995)
block_3 <- read_lines(clippable_filepath, skip = 19965, n_max = 9595)
block_4 <- read_lines(clippable_filepath, skip = 29560, n_max = 9996)
block_5 <- read_lines(clippable_filepath, skip = 39556, n_max = 10000)
write_lines(block_1, paste0(clippable_fileroot, "rs_ceds7_sc_pt1.sql"))
write_lines(block_2, paste0(clippable_fileroot, "rs_ceds7_sc_pt2.sql"))
write_lines(block_3, paste0(clippable_fileroot, "rs_ceds7_sc_pt3.sql"))
write_lines(block_4, paste0(clippable_fileroot, "rs_ceds7_sc_pt4.sql"))
write_lines(block_5, paste0(clippable_fileroot, "rs_ceds7_sc_pt5.sql"))
block_3 <- read_lines(clippable_filepath, skip = 19965, n_max = 9595)
block_4 <- read_lines(clippable_filepath, skip = 29560, n_max = 9996)
block_5 <- read_lines(clippable_filepath, skip = 39556, n_max = 10000)
write_lines(block_1, paste0(clippable_fileroot, "rs_ceds7_sc_pt1.sql"))
write_lines(block_2, paste0(clippable_fileroot, "rs_ceds7_sc_pt2.sql"))
write_lines(block_3, paste0(clippable_fileroot, "rs_ceds7_sc_pt3.sql"))
write_lines(block_4, paste0(clippable_fileroot, "rs_ceds7_sc_pt4.sql"))
write_lines(block_5, paste0(clippable_fileroot, "rs_ceds7_sc_pt5.sql"))
rs_ceds7_sc %<>% gsub("fk_individualized_program_progress_report_individualized_program_progress_report_plan",  "fk_individ_prgrm_prog_rprt_pln_individ_prgrm_prog_rprt_pln", ., perl = T, ignore.case = T)
clippable_fileroot <- "redshift_ceds_v7_snake_case/redshift_ceds_v7_snake_case_script_blocks/"
complete_translation <- "rs_ceds7_sc.sql"
completetranslation_filepath <- paste0(clippable_fileroot, complete_translation)
write_lines(rs_ceds7_sc, completetranslation_filepath)
clippable_filepath <- completetranslation_filepath
block_3 <- read_lines(clippable_filepath, skip = 19965, n_max = 9595)
block_4 <- read_lines(clippable_filepath, skip = 29560, n_max = 9996)
block_1 <- read_lines(clippable_filepath, n_max = 9970)
block_2 <- read_lines(clippable_filepath, skip = 9970, n_max = 9995)
block_3 <- read_lines(clippable_filepath, skip = 19965, n_max = 9595)
block_4 <- read_lines(clippable_filepath, skip = 29560, n_max = 9996)
block_5 <- read_lines(clippable_filepath, skip = 39556, n_max = 10000)
write_lines(block_1, paste0(clippable_fileroot, "rs_ceds7_sc_pt1.sql"))
write_lines(block_2, paste0(clippable_fileroot, "rs_ceds7_sc_pt2.sql"))
write_lines(block_3, paste0(clippable_fileroot, "rs_ceds7_sc_pt3.sql"))
write_lines(block_4, paste0(clippable_fileroot, "rs_ceds7_sc_pt4.sql"))
write_lines(block_5, paste0(clippable_fileroot, "rs_ceds7_sc_pt5.sql"))
rs_ceds7_sc %<>% gsub("'Sun'aq Tribe of Kodiak \\(formerly the Shoonaq' Tribe of Kodiak\\)'",  "'Sun''aq Tribe of Kodiak (formerly the Shoonaq'' Tribe of Kodiak)'", ., perl = T, ignore.case = T)
block_4 <- read_lines(clippable_filepath, skip = 29560, n_max = 9996)
write_lines(block_4, paste0(clippable_fileroot, "rs_ceds7_sc_pt4.sql"))
rs_ceds7_sc %<>% gsub("'Sun'aq Tribe of Kodiak \\(formerly the Shoonaq' Tribe of Kodiak\\)'",  "'Sun''aq Tribe of Kodiak (formerly the Shoonaq'' Tribe of Kodiak)'", ., perl = T, ignore.case = T)
block_4 <- read_lines(clippable_filepath, skip = 29560, n_max = 9996)
write_lines(block_4, paste0(clippable_fileroot, "rs_ceds7_sc_pt4.sql"))
rs_ceds7_sc %<>% gsub("'Sun'aq Tribe of Kodiak \\(formerly the Shoonaq' Tribe of Kodiak\\)'",  "'Sun''aq Tribe of Kodiak (formerly the Shoonaq'' Tribe of Kodiak)'", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
clippable_filepath <- completetranslation_filepath
block_4 <- read_lines(clippable_filepath, skip = 29560, n_max = 9996)
write_lines(block_4, paste0(clippable_fileroot, "rs_ceds7_sc_pt4.sql"))
rs_ceds7_sc %<>% gsub("(?<=\\w )'snap'(?= \\w)",  "''snap''", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
clippable_filepath <- completetranslation_filepath
block_4 <- read_lines(clippable_filepath, skip = 29560, n_max = 9996)
write_lines(block_4, paste0(clippable_fileroot, "rs_ceds7_sc_pt4.sql"))
rs_ceds7_sc %<>% gsub("Doctoral \\(Doctor's\\) degree",  "Doctoral (Doctor''s) degree", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
clippable_filepath <- completetranslation_filepath
block_4 <- read_lines(clippable_filepath, skip = 29560, n_max = 9996)
write_lines(block_4, paste0(clippable_fileroot, "rs_ceds7_sc_pt4.sql"))
rs_ceds7_sc %<>% gsub("fk_k12_student_course_section\\s+_ref_course_gpa_applicability ",  "fk_k12_student_course_section_ref_course_gpa_applicability ", ., perl = T, ignore.case = T)
clippable_filepath <- completetranslation_filepath
block_3 <- read_lines(clippable_filepath, skip = 19965, n_max = 9595)
write_lines(block_3, paste0(clippable_fileroot, "rs_ceds7_sc_pt3.sql"))
rs_ceds7_sc %<>% gsub("fk_k12_student_course_section\\s+_ref_course_gpa_applicability ",  "fk_k12_student_course_section_ref_course_gpa_applicability ", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
clippable_filepath <- completetranslation_filepath
block_1 <- read_lines(clippable_filepath, n_max = 9970)
block_3 <- read_lines(clippable_filepath, skip = 19965, n_max = 9595)
write_lines(block_3, paste0(clippable_fileroot, "rs_ceds7_sc_pt3.sql"))
rs_ceds7_sc %<>% gsub("Has_Option_Set",  "HasOptionSet", ., perl = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
clippable_filepath <- completetranslation_filepath
block_3 <- read_lines(clippable_filepath, skip = 19965, n_max = 9595)
write_lines(block_3, paste0(clippable_fileroot, "rs_ceds7_sc_pt3.sql"))
origscript_path <- "redshift_ceds_v7_snake_case/original/redshift_ceds_v7_snake_case.sql"
rs_ceds_v7_sc_orig <- read_lines(origscript_path)
rs_ceds7_sc <- rs_ceds_v7_sc_orig
rs_ceds7_sc %<>% sub("CREATE SCHEMA dbo;",  "CREATE SCHEMA rs_ceds7_sc;", .)
rs_ceds7_sc %<>% gsub("\\s+dbo\\.",  " rs_ceds7_sc.", .)
rs_ceds7_sc %<>% gsub('"(.*?)"',  "\\L\\1", ., perl = T)
rs_ceds7_sc %<>% gsub("primary_telephone_number_indicator bool DEFAULT 0 NOT NULL",  "primary_telephone_number_indicator bool DEFAULT FALSE NOT NULL", ., perl = T)
rs_ceds7_sc %<>% gsub("fk_ps_section\\s+_ref_course_",  "fk_ps_section_ref_course_", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("student_financial_aid_ref_financial_aid_veterans_benefit",  "student_financial_aid_ref_fin_aid_vtrns_bnft", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("org_identification_system\\s+_ref_organization_identifier_type",  "org_identification_system_ref_organization_identifier_type", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("dentification_system\\s+_ref_person_identifier",  "dentification_system_ref_person_identifier", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("fk_organization_fed(era)*l*_accountability",  "fk_organization_fed_accntblty", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("fk_k12_student_course_section\\s+_ref_course_gpa_applicability ",  "fk_k12_student_course_section_ref_course_gpa_applicability ", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("fk_individualized_program_progress_report_plan",  "fk_individ_prgrm_prog_rprt_pln", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("fk_individualized_program_progress_report_individualized_program_progress_report_plan",  "fk_individ_prgrm_prog_rprt_pln_individ_prgrm_prog_rprt_pln", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')(\\w+)'s(?=\\s+(\\w+|\\())",  "\\1\\2''s", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("='Accrediting Organization' when Accreditation Agency is set to 'Other Accreditation Agency\\.', ",  "=`Accrediting Organization` when Accreditation Agency is set to `Other Accreditation Agency.`',  ", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')(\\w+)n't(?=\\s\\w+)",  "\\1\\2n''t", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')([A-Z]{2})'s(?=\\s\\w+)",  "\\1\\2''s", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')([A-Z]{2})'s'",  "\\1\\2''s'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')(\\w+)s'(?=\\s\\w+)",  "\\1\\2s''", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("Post-master's certificate",  "Post-master''s certificate", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("Doctoral \\(Doctor's\\) degree",  "Doctoral (Doctor''s) degree", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("C\\?te d'Ivoire",  "Cote dIvoire", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+\\?*\\s*\\w+\\?*)''(?=,)",  "'\\1'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+)'(\\w+)'",  "'\\1 \\2'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+\\s)(\\w+)'(\\w+)'",  "'\\1 \\2 \\3'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+)'\\s(\\w+)'",  "'\\1 \\2'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub(", ''(\\w+)(\\s\\w+)', ",  ", '\\1\\2', ", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub(", ''(\\w+)', ",  ", '\\1', ", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+)'(\\w+\\s\\w+)'",  "'\\1\\2'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'Mi'kmaq; Micmac'",  "'Mi''kmaq; Micmac'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("St. Mary's",  "St. Mary''s", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("Port Gamble S'Klallam Tribe",  "Port Gamble S''Klallam Tribe", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub(" \\(formerly SSIG's\\)",  " (formerly SSIG''s)", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'Ta'izzi-Adeni Arabic'",  "'Taizzi Adeni Arabic'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'Daats'i\\?in'",  "'Daatsi?in'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("d'Oreille",  "d''Oreille", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("ut-Ma'in",  "ut-Ma in", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("Hawai'i",  "Hawaii", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("Ju/'hoan",  "Ju/hoan", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("Kuuku-Ya'u",  "Kuuku-Yau", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("E'\\?apa Woromaipu",  "Eapa Woromaipu", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'Zo'\\?'",  "'Zo?'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'Toraja-Sa'dan'",  "'Toraja-Sadan'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("Me'phaa",  "Me phaa", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'Sun'aq Tribe of Kodiak \\(formerly the Shoonaq' Tribe of Kodiak\\)'",  "'Sun''aq Tribe of Kodiak (formerly the Shoonaq'' Tribe of Kodiak)'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(?<=\\w )'snap'(?= \\w)",  "''snap''", ., perl = T, ignore.case = T)
clippable_fileroot <- "redshift_ceds_v7_snake_case/redshift_ceds_v7_snake_case_script_blocks/"
complete_translation <- "rs_ceds7_sc.sql"
completetranslation_filepath <- paste0(clippable_fileroot, complete_translation)
write_lines(rs_ceds7_sc, completetranslation_filepath)
clippable_filepath <- completetranslation_filepath
block_1 <- read_lines(clippable_filepath, n_max = 9970)
block_2 <- read_lines(clippable_filepath, skip = 9970, n_max = 9995)
block_3 <- read_lines(clippable_filepath, skip = 19965, n_max = 9595)
block_4 <- read_lines(clippable_filepath, skip = 29560, n_max = 9996)
block_5 <- read_lines(clippable_filepath, skip = 39556, n_max = 10000)
write_lines(block_1, paste0(clippable_fileroot, "rs_ceds7_sc_pt1.sql"))
write_lines(block_3, paste0(clippable_fileroot, "rs_ceds7_sc_pt3.sql"))
write_lines(block_4, paste0(clippable_fileroot, "rs_ceds7_sc_pt4.sql"))
write_lines(block_5, paste0(clippable_fileroot, "rs_ceds7_sc_pt5.sql"))
library(tidyverse)
library(magrittr)
origscript_path <- "redshift_ceds_v7_snake_case/original/redshift_ceds_v7_snake_case.sql"
rs_ceds_v7_sc_orig <- read_lines(origscript_path)
rs_ceds7_sc <- rs_ceds_v7_sc_orig
rs_ceds7_sc %<>% sub("CREATE SCHEMA dbo;",  "CREATE SCHEMA rs_ceds7_sc;", .)
rs_ceds7_sc %<>% gsub("\\s+dbo\\.",  " rs_ceds7_sc.", .)
rs_ceds7_sc %<>% gsub('"(.*?)"',  "\\L\\1", ., perl = T)
rs_ceds7_sc %<>% gsub("primary_telephone_number_indicator bool DEFAULT 0 NOT NULL",  "primary_telephone_number_indicator bool DEFAULT FALSE NOT NULL", ., perl = T)
rs_ceds7_sc %<>% gsub("fk_ps_section\\s+_ref_course_",  "fk_ps_section_ref_course_", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("student_financial_aid_ref_financial_aid_veterans_benefit",  "student_financial_aid_ref_fin_aid_vtrns_bnft", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("org_identification_system\\s+_ref_organization_identifier_type",  "org_identification_system_ref_organization_identifier_type", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("dentification_system\\s+_ref_person_identifier",  "dentification_system_ref_person_identifier", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("fk_k12_student_course_section\\s+_ref_course_gpa_applicability ",  "fk_k12_student_course_section_ref_course_gpa_applicability ", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("fk_organization_fed(era)*l*_accountability",  "fk_organization_fed_accntblty", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("fk_individualized_program_progress_report_plan",  "fk_individ_prgrm_prog_rprt_pln", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("fk_individualized_program_progress_report_individualized_program_progress_report_plan",  "fk_individ_prgrm_prog_rprt_pln_individ_prgrm_prog_rprt_pln", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')(\\w+)'s(?=\\s+(\\w+|\\())",  "\\1\\2''s", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("='Accrediting Organization' when Accreditation Agency is set to 'Other Accreditation Agency\\.', ",  "=`Accrediting Organization` when Accreditation Agency is set to `Other Accreditation Agency.`',  ", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')(\\w+)n't(?=\\s\\w+)",  "\\1\\2n''t", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')([A-Z]{2})'s(?=\\s\\w+)",  "\\1\\2''s", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')([A-Z]{2})'s'",  "\\1\\2''s'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(\\s|')(\\w+)s'(?=\\s\\w+)",  "\\1\\2s''", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("Post-master's certificate",  "Post-master''s certificate", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("Doctoral \\(Doctor's\\) degree",  "Doctoral (Doctor''s) degree", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("C\\?te d'Ivoire",  "Cote dIvoire", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+\\?*\\s*\\w+\\?*)''(?=,)",  "'\\1'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+)'(\\w+)'",  "'\\1 \\2'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+\\s)(\\w+)'(\\w+)'",  "'\\1 \\2 \\3'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+)'\\s(\\w+)'",  "'\\1 \\2'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub(", ''(\\w+)(\\s\\w+)', ",  ", '\\1\\2', ", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub(", ''(\\w+)', ",  ", '\\1', ", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'(\\w+)'(\\w+\\s\\w+)'",  "'\\1\\2'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'Mi'kmaq; Micmac'",  "'Mi''kmaq; Micmac'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("St. Mary's",  "St. Mary''s", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("Port Gamble S'Klallam Tribe",  "Port Gamble S''Klallam Tribe", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub(" \\(formerly SSIG's\\)",  " (formerly SSIG''s)", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'Ta'izzi-Adeni Arabic'",  "'Taizzi Adeni Arabic'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'Daats'i\\?in'",  "'Daatsi?in'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("d'Oreille",  "d''Oreille", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("ut-Ma'in",  "ut-Ma in", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("Hawai'i",  "Hawaii", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("Ju/'hoan",  "Ju/hoan", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("Kuuku-Ya'u",  "Kuuku-Yau", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("E'\\?apa Woromaipu",  "Eapa Woromaipu", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'Zo'\\?'",  "'Zo?'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'Toraja-Sa'dan'",  "'Toraja-Sadan'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("Me'phaa",  "Me phaa", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("'Sun'aq Tribe of Kodiak \\(formerly the Shoonaq' Tribe of Kodiak\\)'",  "'Sun''aq Tribe of Kodiak (formerly the Shoonaq'' Tribe of Kodiak)'", ., perl = T, ignore.case = T)
rs_ceds7_sc %<>% gsub("(?<=\\w )'snap'(?= \\w)",  "''snap''", ., perl = T, ignore.case = T)
clippable_fileroot <- "redshift_ceds_v7_snake_case/redshift_ceds_v7_snake_case_script_blocks/"
complete_translation <- "rs_ceds7_sc.sql"
completetranslation_filepath <- paste0(clippable_fileroot, complete_translation)
write_lines(rs_ceds7_sc, completetranslation_filepath)
clippable_filepath <- completetranslation_filepath
block_1 <- read_lines(clippable_filepath, n_max = 9970)
block_2 <- read_lines(clippable_filepath, skip = 9970, n_max = 9995)
block_3 <- read_lines(clippable_filepath, skip = 19965, n_max = 9595)
block_4 <- read_lines(clippable_filepath, skip = 29560, n_max = 9996)
block_5 <- read_lines(clippable_filepath, skip = 39556, n_max = 10000)
write_lines(block_1, paste0(clippable_fileroot, "rs_ceds7_sc_pt1.sql"))
write_lines(block_3, paste0(clippable_fileroot, "rs_ceds7_sc_pt3.sql"))
write_lines(block_4, paste0(clippable_fileroot, "rs_ceds7_sc_pt4.sql"))
write_lines(block_5, paste0(clippable_fileroot, "rs_ceds7_sc_pt5.sql"))
rs_ceds7_sc %<>% gsub(" student's', ",  " student''s', ", ., perl = T, ignore.case = T)
