mutate_all(round) %>%
summarise_all(funs(sum)) %>%
mutate_all(funs(as.numeric)) %>%
collect %>%
.[[1]]
sum_of_column
}
csv_convertAllText2bigint <- function (file_)
{
read_charxl_full(paste0(file_,".xlsx")) %>%
select(1:11) %>%
mutate(AmountNumeric = suppressWarnings(as.numeric(.[[ncol(.)]]))) %>% # last col to int
mutate(AmountRounded = round(.[[ncol(.)]])) %>% # round last col
select(1:10, ncol(.)) %>% # select 10 + Corrected Amount
filter(suppressWarnings(!is.na(AmountRounded))) %>%
mutate_all(funs(as.integer64(.))) %>%
write.csv(paste0(file_,".csv"), na = "", row.names = F)
}
chopit <- function(element) {
substr(element, 1, 5)
}
read_csv_data <- function(csv_file)
{
csv_data <-
read.csv(paste0(csv_file, ".csv"),
stringsAsFactors = F,
na.strings = c("", " ", "NA")) %>%
# mutate_all(funs(as.integer_spprssWrns)) #regular
mutate_all(funs(as.double_spprssWrns)) #oversized
csv_data
}
dataRowCount_csv <- function(csv_file)
{
dataRowCount <-
read_csv_data(csv_file) %>%
nrow
dataRowCount
}
sumOfColumn_csv <- function(csv_file)
{
sum_of_column <-
read_csv_data(csv_file) %>%
select(11) %>%
summarise_all(funs(sum)) %>%
collect %>%
.[[1]]
sum_of_column
}
file_extension <- "xlsx"
getwd()
file_path <- "C:/Users/Koyot/Documents/GitHub/readxl_bulkloadR/bulkloadR_staging/"
setwd(file_path)
options(stringsAsFactors = FALSE) # To deal with the UTF-16 format read.csv is necessary
library(tidyverse)
library(magrittr)
library(tidyverse)
library(magrittr)
getwd()
setwd("../../aws_ceds_v7/")
createUpdate_CEDS6_TSQL <- read_lines("/TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
createUpdate_CEDS6_TSQL <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
cu_ceds6_tsql_sc <- gsub("(?<=[a-z0-9])[A-Z]|(?!^)[A-Z](?=[a-z])", "_\\1", createUpdate_CEDS6_TSQL, perl = T)
cu_ceds6_tsql_sc %<>% gsub("\\[CEDS-TSQL-V7\\]",  "\\[CEDS_TSQL_v7_snake_case\\]", .)
dir.create("tsql_ceds_v7_snake_case")
clippablefile_path <- "tsql_ceds_v7_snake_case_/tsql_ceds_v7_snake_case.sql"
write_lines(cu_ceds6_tsql_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("(?<=[a-z0-9])[A-Z]|(?!^)[A-Z](?=[a-z])", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc %<>% gsub("\\[CEDS-TSQL-V7\\]",  "\\[CEDS_TSQL_v7_snake_case\\]", .)
tsql_ceds7_sc %<>% gsub("Progress_([ABC])Indicator",  "Progress_\\1_Indicator", ., perl = T)
tsql_ceds7_sc %<>% gsub("Rating_([ABC])Id",  "Rating_\\1_Id", ., perl = T)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("(?<=[a-z0-9])[A-Z]|(?!^)[A-Z](?=[a-z])", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc %<>% gsub("\\[CEDS-TSQL-V7\\]",  "\\[CEDS_TSQL_v7_snake_case\\]", .)
clippablefile_path <- "tsql_ceds_v7_snake_case_/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("(?<=[a-z0-9])[A-Z]|(?!^)[A-Z](?=[a-z])", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc %<>% gsub("\\[CEDS-TSQL-V7\\]",  "\\[CEDS_TSQL_v7_snake_case\\]", .)
dir.create("tsql_ceds_v7_snake_case")
clippablefile_path <- "tsql_ceds_v7_snake_case_/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
clippablefile_path <- file("tsql_ceds_v7_snake_case_/tsql_ceds_v7_snake_case.sql")
write_lines(tsql_ceds7_sc, clippablefile_path)
clippablefile_path <- file("tsql_ceds_v7_snake_case_/tsql_ceds_v7_snake_case.sql")
write_lines(tsql_ceds7_sc, clippablefile_path)
dir.create("tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case.sql")
clippablefile_path <- file("tsql_ceds_v7_snake_case_/tsql_ceds_v7_snake_case.sql")
write_lines(tsql_ceds7_sc, clippablefile_path)
writeLines(tsql_ceds7_sc, clippablefile_path)
clippablefile_path <- file("tsql_ceds_v7_snake_case_/tsql_ceds_v7_snake_case.sql")
writeLines(tsql_ceds7_sc, clippablefile_path)
clippablefile_path <- "tsql_ceds_v7_snake_case_/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
file.create("createUpdateTSQLCEDSv7")
clippablefile_path <- "tsql_ceds_v7_snake_case_/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
file.create("createUpdateTSQLCEDSv7.sql")
clippablefile_path <- "tsql_ceds_v7_snake_case_/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
file.create("tsql_ceds_v7_snake_case/createUpdateTSQLCEDSv7.sql")
clippablefile_path <- "tsql_ceds_v7_snake_case_/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
file.create("tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case.sql")
clippablefile_path <- "tsql_ceds_v7_snake_case_/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
clippablefile_path <- "tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?!^)[A-Z](?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc %<>% gsub("\\[CEDS-NDS-V7\\]",  "\\[tsql_ceds7_sc\\]", .)
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?![)[A-Z](?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?!\\[)[A-Z](?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9\\[])[A-Z]|(?!^)[A-Z](?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9\\\[])[A-Z]|(?!^)[A-Z](?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?!\\[)[A-Z](?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
write_lines(tsql_ceds7_sc, clippablefile_path)
tsql_ceds7_sc <- createUpdateTSQLCEDSv7
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?![\\[])[A-Z](?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[])[A-Z](?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[])[A-Z](?!to)(?=[a-z])", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[])[A-Z](?!=to)(?=[a-z])", "_\\1", createUpdateTSQLCEDSv7, perl = T)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[])[A-Z](?!to)(?=[a-z])", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[])[A-Z](?!(to))(?=[a-z])", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[])[A-Z](?!to)(?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[])[A-Z](?!to)(?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc %<>% gsub("\\[CEDS-NDS-V7\\]",  "\\[tsql_ceds7_sc\\]", .)
tsql_ceds7_sc %<>% gsub("CEDSto_",  "CEDS_to_", ., perl = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[\\'])[A-Z](?!to)(?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc %<>% gsub("\\[CEDS-NDS-V7\\]",  "\\[tsql_ceds7_sc\\]", .)
tsql_ceds7_sc %<>% gsub("CEDSto_",  "CEDS_to_", ., perl = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[\\'])[A-Z](?!to)(?=[a-z])|(?!^)[A-Z](?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc %<>% gsub("\\[CEDS-NDS-V7\\]",  "\\[tsql_ceds7_sc\\]", .)
tsql_ceds7_sc %<>% gsub("CEDSto_",  "CEDS_to_", ., perl = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[\\'\\s+])[A-Z](?!to)(?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc %<>% gsub("\\[CEDS-NDS-V7\\]",  "\\[tsql_ceds7_sc\\]", .)
tsql_ceds7_sc %<>% gsub("CEDSto_",  "CEDS_to_", ., perl = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
tsql_ceds7_sc %<>% gsub("Pre_*K(indergarten)*",  "Pre_K\\1_", ., perl = T, ignore.case = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
tsql_ceds7_sc %<>% gsub("Title_*1",  "Title_1_", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("Is_User_Table",  "IsUserTable", ., perl = T, ignore.case = T)
write_lines(tsql_ceds7_sc, clippablefile_path)
sc <- function(dat, ABBR) {
gsub(paste0("('|_|\\[)", ABBR, "([A-Z])"),  paste0("\\1", ABBR, "_\\2"), dat, perl = T)
}
tsql_ceds7_sc %<>% sc(., "IEP")
write_lines(tsql_ceds7_sc, clippablefile_path)
sc <- function(dat, ABBR) {
sc <- function(dat, ABBR) {
gsub(paste0("('|_|\\[)", ABBR, "([A-Z])"),  paste0("\\1", ABBR, "_\\2"), dat, perl = T)
}
sc <- function(dat, ABBR) {
gsub(paste0("('|_|\\[)", ABBR, "([A-Z])"),  paste0("\\1", ABBR, "_\\2"), dat, perl = T)
}
tsql_ceds7_sc %<>% sc(., "IDEA")
write_lines(tsql_ceds7_sc, clippablefile_path)
tsql_ceds7_sc %<>% sc(., "XPK")
write_lines(tsql_ceds7_sc, clippablefile_path)
tsql_ceds7_sc %<>% gsub("__",  "_", .)
write_lines(tsql_ceds7_sc, clippablefile_path)
tsql_ceds7_sc %<>% gsub("__",  "_", .)
clippablefile_path <- "tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[\\'\\s+])[A-Z](?!to)(?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc %<>% gsub("\\[CEDS-NDS-V7\\]",  "\\[tsql_ceds7_sc\\]", .)
tsql_ceds7_sc %<>% gsub("CEDSto_",  "CEDS_to_", ., perl = T)
tsql_ceds7_sc %<>% gsub("Pre_*K(indergarten)*",  "Pre_K\\1_", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("Title_*1",  "Title_1_", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("CENSUSID",  "CENSUS_ID", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("Is_User_Table",  "IsUserTable", ., perl = T, ignore.case = T)
sc <- function(dat, ABBR) {
gsub(paste0("('|_|\\[)", ABBR, "([A-Z])"),  paste0("\\1", ABBR, "_\\2"), dat, perl = T)
}
tsql_ceds7_sc %<>% sc(., "IDEA")
tsql_ceds7_sc %<>% sc(., "IEP")
tsql_ceds7_sc %<>% sc(., "XPK")
tsql_ceds7_sc %<>% sc(., "Part_B")
tsql_ceds7_sc %<>% gsub("__",  "_", .)
clippablefile_path <- "tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
tsql_ceds7_sc %<>% gsub("__",  "_", .)
clippablefile_path <- "tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[\\'\\s+])[A-Z](?!to)(?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc %<>% gsub("\\[CEDS-NDS-V7\\]",  "\\[tsql_ceds7_sc\\]", .)
tsql_ceds7_sc %<>% gsub("CEDSto_",  "CEDS_to_", ., perl = T)
tsql_ceds7_sc %<>% gsub("Pre_*K(indergarten)*",  "Pre_K\\1_", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("Title_*1",  "Title_1_", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("CENSUSID",  "CENSUS_ID", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("Is_User_Table",  "IsUserTable", ., perl = T, ignore.case = T)
sc <- function(dat, ABBR) {
gsub(paste0("('|_|\\[)", ABBR, "([A-Z])"),  paste0("\\1", ABBR, "_\\2"), dat, perl = T)
}
tsql_ceds7_sc %<>% sc(., "IDEA")
tsql_ceds7_sc %<>% sc(., "IEP")
tsql_ceds7_sc %<>% sc(., "XPK")
tsql_ceds7_sc %<>% sc(., "Part_B")
write_lines(tsql_ceds7_sc, clippablefile_path)
tsql_ceds7_sc %<>% gsub("_+",  "_", .)
clippablefile_path <- "tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
library(tidyverse)
library(magrittr)
library(pastecs)
block_1 <- read_lines(clippablefile_path, n_max = 9993)
block_2 <- read_lines(clippablefile_path, skip = 9993, n_max = 9000)
write_lines(block_1, paste0(clippablefile_root, "tsql_ceds6sc_create_update_redux_pt1.sql"))
clippablefile_root <- "tsql_ceds6_snake_case_redux/"
clippablefile_root <- "tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case_blocks/"
dir.create(clippablefile_root)
write_lines(block_1, paste0(clippablefile_root, "tsql_ceds6sc_create_update_redux_pt1.sql"))
clippablefile_path <- "tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case.sql"
block_1 <- read_lines(clippablefile_path, n_max = 9993)
block_2 <- read_lines(clippablefile_path, skip = 9993, n_max = 9000)
write_lines(block_1, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt1.sql"))
write_lines(block_2, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt2.sql"))
block_3 <- read_lines(clippablefile_path, skip = 18993, n_max = 1000)
write_lines(block_3, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt3.sql"))
block_3 <- read_lines(clippablefile_path, skip = 18993, n_max = 10000)
write_lines(block_3, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt3.sql"))
block_3 <- read_lines(clippablefile_path, skip = 18993, n_max = 9994)
write_lines(block_3, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt3.sql"))
block_4 <- read_lines(clippablefile_path, skip = 28988, n_max = 10000)
write_lines(block_4, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt4.sql"))
block_4 <- read_lines(clippablefile_path, skip = 28988, n_max = 9988)
write_lines(block_4, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt4.sql"))
block_5 <- read_lines(clippablefile_path, skip = 38977, n_max = 10000)
write_lines(block_5, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt5.sql"))
block_5 <- read_lines(clippablefile_path, skip = 38977, n_max = 9995)
write_lines(block_5, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt5.sql"))
block_6 <- read_lines(clippablefile_path, skip = 48974, n_max = 10000)
write_lines(block_6, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt6.sql"))
block_6 <- read_lines(clippablefile_path, skip = 48974, n_max = 9993)
write_lines(block_6, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt6.sql"))
block_6 <- read_lines(clippablefile_path, skip = 48974, n_max = 9993)
write_lines(block_6, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt6.sql"))
block_7 <- read_lines(clippablefile_path, skip = 58968, n_max = 10000)
write_lines(block_7, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt7.sql"))
block_7 <- read_lines(clippablefile_path, skip = 58968, n_max = 9946)
write_lines(block_7, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt7.sql"))
block_7 <- read_lines(clippablefile_path, skip = 68915, n_max = 10000)
block_7 <- read_lines(clippablefile_path, skip = 58968, n_max = 9946)
write_lines(block_8, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt8.sql"))
block_8 <- read_lines(clippablefile_path, skip = 68915, n_max = 10000)
write_lines(block_8, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt8.sql"))
block_8 <- read_lines(clippablefile_path, skip = 68915, n_max = 9997)
write_lines(block_8, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt8.sql"))
block_9 <- read_lines(clippablefile_path, skip = 78913, n_max = 10000)
write_lines(block_9, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt9.sql"))
write_lines(block_8, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt8.sql"))
write_lines(block_9, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt9.sql"))
block_9 <- read_lines(clippablefile_path, skip = 78913, n_max = 9991)
write_lines(block_9, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt9.sql"))
block_10 <- read_lines(clippablefile_path, skip = 88905, n_max = 10000)
write_lines(block_10, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt10.sql"))
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[\\'\\s+])[A-Z](?!to)(?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc %<>% gsub("\\[CEDS-NDS-V7\\]",  "\\[tsql_ceds7_sc\\]", .)
tsql_ceds7_sc %<>% gsub("CEDSto_",  "CEDS_to_", ., perl = T)
tsql_ceds7_sc %<>% gsub("Pre_*K(indergarten)*",  "Pre_K\\1_", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("Title_*1",  "Title_1_", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("CENSUSID",  "CENSUS_ID", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("Is_User_Table",  "IsUserTable", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("\\._Value",  ".Value", ., perl = T, ignore.case = T)
sc <- function(dat, ABBR) {
gsub(paste0("('|_|\\[)", ABBR, "([A-Z])"),  paste0("\\1", ABBR, "_\\2"), dat, perl = T)
}
tsql_ceds7_sc %<>% sc(., "IDEA")
tsql_ceds7_sc %<>% sc(., "IEP")
tsql_ceds7_sc %<>% sc(., "XPK")
tsql_ceds7_sc %<>% sc(., "Part_B")
tsql_ceds7_sc %<>% gsub("_+",  "_", .)
clippablefile_path <- "tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
block_1 <- read_lines(clippablefile_path, n_max = 9993)
block_2 <- read_lines(clippablefile_path, skip = 9993, n_max = 9000)
block_3 <- read_lines(clippablefile_path, skip = 18993, n_max = 9994)
block_4 <- read_lines(clippablefile_path, skip = 28988, n_max = 9988)
block_5 <- read_lines(clippablefile_path, skip = 38977, n_max = 9995)
block_6 <- read_lines(clippablefile_path, skip = 48974, n_max = 9993)
block_7 <- read_lines(clippablefile_path, skip = 58968, n_max = 9946)
block_8 <- read_lines(clippablefile_path, skip = 68915, n_max = 9997)
block_9 <- read_lines(clippablefile_path, skip = 78913, n_max = 9991)
block_10 <- read_lines(clippablefile_path, skip = 88905, n_max = 10000)
clippablefile_root <- "tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case_blocks/"
dir.create(clippablefile_root)
write_lines(block_1, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt1.sql"))
write_lines(block_2, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt2.sql"))
write_lines(block_3, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt3.sql"))
write_lines(block_4, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt4.sql"))
write_lines(block_5, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt5.sql"))
write_lines(block_6, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt6.sql"))
write_lines(block_7, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt7.sql"))
write_lines(block_8, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt8.sql"))
write_lines(block_9, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt9.sql"))
write_lines(block_10, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt10.sql"))
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[\\'\\s+\\.])[A-Z](?!to)(?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc %<>% gsub("\\[CEDS-NDS-V7\\]",  "\\[tsql_ceds7_sc\\]", .)
tsql_ceds7_sc %<>% gsub("CEDSto_",  "CEDS_to_", ., perl = T)
tsql_ceds7_sc %<>% gsub("Pre_*K(indergarten)*",  "Pre_K\\1_", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("Title_*1",  "Title_1_", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("CENSUSID",  "CENSUS_ID", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("Is_User_Table",  "IsUserTable", ., perl = T, ignore.case = T)
sc <- function(dat, ABBR) {
gsub(paste0("('|_|\\[)", ABBR, "([A-Z])"),  paste0("\\1", ABBR, "_\\2"), dat, perl = T)
}
tsql_ceds7_sc %<>% sc(., "IDEA")
tsql_ceds7_sc %<>% sc(., "IEP")
tsql_ceds7_sc %<>% sc(., "XPK")
tsql_ceds7_sc %<>% sc(., "Part_B")
tsql_ceds7_sc %<>% gsub("_+",  "_", .)
clippablefile_path <- "tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
block_1 <- read_lines(clippablefile_path, n_max = 9993)
block_2 <- read_lines(clippablefile_path, skip = 9993, n_max = 9000)
block_3 <- read_lines(clippablefile_path, skip = 18993, n_max = 9994)
block_4 <- read_lines(clippablefile_path, skip = 28988, n_max = 9988)
block_5 <- read_lines(clippablefile_path, skip = 38977, n_max = 9995)
block_6 <- read_lines(clippablefile_path, skip = 48974, n_max = 9993)
block_7 <- read_lines(clippablefile_path, skip = 58968, n_max = 9946)
block_8 <- read_lines(clippablefile_path, skip = 68915, n_max = 9997)
block_9 <- read_lines(clippablefile_path, skip = 78913, n_max = 9991)
block_10 <- read_lines(clippablefile_path, skip = 88905, n_max = 10000)
clippablefile_root <- "tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case_blocks/"
write_lines(block_1, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt1.sql"))
write_lines(block_2, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt2.sql"))
write_lines(block_3, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt3.sql"))
write_lines(block_4, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt4.sql"))
write_lines(block_5, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt5.sql"))
write_lines(block_6, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt6.sql"))
write_lines(block_7, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt7.sql"))
write_lines(block_8, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt8.sql"))
write_lines(block_9, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt9.sql"))
write_lines(block_10, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt10.sql"))
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[\\'\\s+\\.@\\()])[A-Z](?!to)(?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc %<>% gsub("\\[CEDS-NDS-V7\\]",  "\\[tsql_ceds7_sc\\]", .)
tsql_ceds7_sc %<>% gsub("CEDSto_",  "CEDS_to_", ., perl = T)
tsql_ceds7_sc %<>% gsub("Pre_*K(indergarten)*",  "Pre_K\\1_", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("Title_*1",  "Title_1_", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("CENSUSID",  "CENSUS_ID", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("Is_User_Table",  "IsUserTable", ., perl = T, ignore.case = T)
sc <- function(dat, ABBR) {
gsub(paste0("('|_|\\[)", ABBR, "([A-Z])"),  paste0("\\1", ABBR, "_\\2"), dat, perl = T)
}
tsql_ceds7_sc %<>% sc(., "IDEA")
tsql_ceds7_sc %<>% sc(., "IEP")
tsql_ceds7_sc %<>% sc(., "XPK")
tsql_ceds7_sc %<>% sc(., "Part_B")
tsql_ceds7_sc %<>% gsub("_+",  "_", .)
clippablefile_path <- "tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
block_1 <- read_lines(clippablefile_path, n_max = 9993)
block_2 <- read_lines(clippablefile_path, skip = 9993, n_max = 9000)
block_3 <- read_lines(clippablefile_path, skip = 18993, n_max = 9994)
block_4 <- read_lines(clippablefile_path, skip = 28988, n_max = 9988)
block_5 <- read_lines(clippablefile_path, skip = 38977, n_max = 9995)
block_6 <- read_lines(clippablefile_path, skip = 48974, n_max = 9993)
block_7 <- read_lines(clippablefile_path, skip = 58968, n_max = 9946)
block_8 <- read_lines(clippablefile_path, skip = 68915, n_max = 9997)
block_9 <- read_lines(clippablefile_path, skip = 78913, n_max = 9991)
block_10 <- read_lines(clippablefile_path, skip = 88905, n_max = 10000)
clippablefile_root <- "tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case_blocks/"
write_lines(block_1, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt1.sql"))
write_lines(block_2, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt2.sql"))
write_lines(block_3, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt3.sql"))
write_lines(block_4, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt4.sql"))
write_lines(block_5, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt5.sql"))
write_lines(block_6, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt6.sql"))
write_lines(block_7, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt7.sql"))
write_lines(block_8, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt8.sql"))
write_lines(block_9, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt9.sql"))
write_lines(block_10, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt10.sql"))
block_7 <- read_lines(clippablefile_path, skip = 58969, n_max = 9946)
block_8 <- read_lines(clippablefile_path, skip = 68915, n_max = 9997)
block_9 <- read_lines(clippablefile_path, skip = 78913, n_max = 9991)
block_10 <- read_lines(clippablefile_path, skip = 88905, n_max = 10000)
clippablefile_root <- "tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case_blocks/"
write_lines(block_1, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt1.sql"))
write_lines(block_2, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt2.sql"))
write_lines(block_3, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt3.sql"))
write_lines(block_4, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt4.sql"))
write_lines(block_5, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt5.sql"))
write_lines(block_6, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt6.sql"))
write_lines(block_7, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt7.sql"))
write_lines(block_8, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt8.sql"))
write_lines(block_9, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt9.sql"))
write_lines(block_10, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt10.sql"))
block_7 <- read_lines(clippablefile_path, skip = 58967, n_max = 9946)
block_8 <- read_lines(clippablefile_path, skip = 68915, n_max = 9997)
block_9 <- read_lines(clippablefile_path, skip = 78913, n_max = 9991)
block_10 <- read_lines(clippablefile_path, skip = 88905, n_max = 10000)
write_lines(block_7, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt7.sql"))
write_lines(block_8, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt8.sql"))
write_lines(block_9, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt9.sql"))
write_lines(block_10, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt10.sql"))
block_7 <- read_lines(clippablefile_path, skip = 58967, n_max = 9946)
block_8 <- read_lines(clippablefile_path, skip = 63872, n_max = 9997)
write_lines(block_10, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt10.sql"))
write_lines(block_9, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt9.sql"))
block_9 <- read_lines(clippablefile_path, skip = 78912, n_max = 9991)
block_8 <- read_lines(clippablefile_path, skip = 68915, n_max = 9997)
write_lines(block_9, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt9.sql"))
origscript_path <- "awsql_ceds_v7_snake_case/redshift_ceds_v7_snake_case.sql"
rs_ceds7_sc <- cu_ceds6_awsql_sc_orig
rs_ceds_v7_sc_orig <- read_lines(origscript_path)
rs_ceds7_sc <- rs_ceds_v7_sc_orig
rs_ceds7_sc %<>% sub("CREATE SCHEMA dbo;",  " CREATE SCHEMA rs_ceds7_sc;", .)
clippable_fileroot <- "awsql_ceds_v7_snake_case/awsql_ceds_v7_snake_case_script_blocks"
complete_translation <- "rs_ceds7_sc.sql"
completetranslation_filepath <- paste0(clippable_fileroot, complete_translation)
write_lines(rs_ceds7_sc, completetranslation_filepath)
clippable_fileroot <- "awsql_ceds_v7_snake_case/awsql_ceds_v7_snake_case_script_blocks/"
complete_translation <- "rs_ceds7_sc.sql"
completetranslation_filepath <- paste0(clippable_fileroot, complete_translation)
write_lines(rs_ceds7_sc, completetranslation_filepath)
dir.create(clippable_fileroot)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("\\s+dbo\\.",  " rs_ceds7_sc.", .)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub('"(.*?)"',  "\\L\\1", ., perl = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("primary_telephone_number_indicator bool DEFAULT 0 NOT NULL",  "primary_telephone_number_indicator bool DEFAULT FALSE NOT NULL", ., perl = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("fk_ps_section\\s+_ref_course_",  "fk_ps_section_ref_course_", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds_v7_sc_orig <- read_lines(origscript_path)
rs_ceds7_sc <- rs_ceds_v7_sc_orig
rs_ceds7_sc %<>% sub("CREATE SCHEMA dbo;",  " CREATE SCHEMA rs_ceds7_sc;", .)
rs_ceds7_sc %<>% gsub("\\s+dbo\\.",  " rs_ceds7_sc.", .)
rs_ceds7_sc %<>% gsub('"(.*?)"',  "\\L\\1", ., perl = T)
origscript_path <- "awsql_ceds_v7_snake_case/redshift_ceds_v7_snake_case.sql"
rs_ceds_v7_sc_orig <- read_lines(origscript_path)
origscript_path <- "awsql_ceds_v7_snake_case/original/redshift_ceds_v7_snake_case.sql"
rs_ceds_v7_sc_orig <- read_lines(origscript_path)
rs_ceds7_sc <- rs_ceds_v7_sc_orig
rs_ceds7_sc %<>% sub("CREATE SCHEMA dbo;",  " CREATE SCHEMA rs_ceds7_sc;", .)
rs_ceds7_sc %<>% gsub("\\s+dbo\\.",  " rs_ceds7_sc.", .)
rs_ceds7_sc %<>% gsub('"(.*?)"',  "\\L\\1", ., perl = T)
rs_ceds7_sc %<>% gsub("primary_telephone_number_indicator bool DEFAULT 0 NOT NULL",  "primary_telephone_number_indicator bool DEFAULT FALSE NOT NULL", ., perl = T)
rs_ceds7_sc %<>% gsub("fk_ps_section\\s+_ref_course_",  "fk_ps_section_ref_course_", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("student_financial_aid_ref_financial_aid_veterans_benefit",  "student_financial_aid_ref_fin_aid_vtrns_bnft", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
rs_ceds7_sc %<>% gsub("org_identification_system\\s+_ref_organization_identifier_type",  "org_identification_system_ref_organization_identifier_type", ., perl = T, ignore.case = T)
write_lines(rs_ceds7_sc, completetranslation_filepath)
createUpdateTSQLCEDSv7 <- read_lines("TSQLv7_camelCase/TSQLv7_camelCase_completeDebuggedCreateInsert.sql")
tsql_ceds7_sc <- gsub("((?<=[a-z0-9])[A-Z]|(?<![\\[\\'\\s+\\.@\\(\\\"])[A-Z](?!to)(?=[a-z]))", "_\\1", createUpdateTSQLCEDSv7, perl = T)
tsql_ceds7_sc %<>% gsub("\\[CEDS-NDS-V7\\]",  "\\[tsql_ceds7_sc\\]", .)
tsql_ceds7_sc %<>% gsub("CEDSto_",  "CEDS_to_", ., perl = T)
tsql_ceds7_sc %<>% gsub("Pre_*K(indergarten)*",  "Pre_K\\1_", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("Title_*1",  "Title_1_", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("CENSUSID",  "CENSUS_ID", ., perl = T, ignore.case = T)
tsql_ceds7_sc %<>% gsub("Is_User_Table",  "IsUserTable", ., perl = T, ignore.case = T)
sc <- function(dat, ABBR) {
gsub(paste0("('|_|\\[)", ABBR, "([A-Z])"),  paste0("\\1", ABBR, "_\\2"), dat, perl = T)
}
tsql_ceds7_sc %<>% sc(., "IDEA")
tsql_ceds7_sc %<>% sc(., "IEP")
tsql_ceds7_sc %<>% sc(., "XPK")
tsql_ceds7_sc %<>% sc(., "Part_B")
tsql_ceds7_sc %<>% gsub("_+",  "_", .)
clippablefile_path <- "tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case.sql"
write_lines(tsql_ceds7_sc, clippablefile_path)
block_1 <- read_lines(clippablefile_path, n_max = 9993)
block_2 <- read_lines(clippablefile_path, skip = 9993, n_max = 9000)
block_3 <- read_lines(clippablefile_path, skip = 18993, n_max = 9994)
block_4 <- read_lines(clippablefile_path, skip = 28988, n_max = 9988)
block_5 <- read_lines(clippablefile_path, skip = 38977, n_max = 9995)
block_6 <- read_lines(clippablefile_path, skip = 48974, n_max = 9993)
block_7 <- read_lines(clippablefile_path, skip = 58967, n_max = 9946)
block_8 <- read_lines(clippablefile_path, skip = 68915, n_max = 9997)
block_9 <- read_lines(clippablefile_path, skip = 78912, n_max = 9991)
block_10 <- read_lines(clippablefile_path, skip = 88905, n_max = 10000)
clippablefile_root <- "tsql_ceds_v7_snake_case/tsql_ceds_v7_snake_case_blocks/"
write_lines(block_1, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt1.sql"))
write_lines(block_2, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt2.sql"))
write_lines(block_3, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt3.sql"))
write_lines(block_4, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt4.sql"))
write_lines(block_5, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt5.sql"))
write_lines(block_6, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt6.sql"))
write_lines(block_7, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt7.sql"))
write_lines(block_8, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt8.sql"))
write_lines(block_9, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt9.sql"))
write_lines(block_10, paste0(clippablefile_root, "tsql_ceds_v7_snake_case_pt10.sql"))
